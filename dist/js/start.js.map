{
  "version": 3,
  "sources": ["src/js/utils/LCPFile.ts", "src/js/start.ts"],
  "sourcesContent": ["// \u0424\u0443\u043D\u043A\u0446\u0438\u044F \u0434\u043B\u044F \u0434\u043E\u0431\u0430\u0432\u043B\u0435\u043D\u0438\u044F \u043F\u0440\u0435\u0434\u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0438 \u0434\u043B\u044F LCP \u044D\u043B\u0435\u043C\u0435\u043D\u0442\u0430\r\nexport function addPreloadToLCP(): void {\r\n    const lcpElements: (HTMLImageElement | HTMLVideoElement | HTMLPictureElement | HTMLElement)[] = [\r\n        ...document.querySelectorAll('img, video, picture, .lcp-text')  // \u0414\u043E\u0431\u0430\u0432\u043B\u044F\u0435\u043C \u0438\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u044F, \u0432\u0438\u0434\u0435\u043E, picture \u0438 \u0442\u0435\u043A\u0441\u0442\u043E\u0432\u044B\u0435 \u044D\u043B\u0435\u043C\u0435\u043D\u0442\u044B \u0441 \u043A\u043B\u0430\u0441\u0441\u043E\u043C .lcp-text\r\n    ];\r\n\r\n    let lcpElement: HTMLElement | null = null;\r\n\r\n    // \u0418\u0449\u0435\u043C \u043F\u0435\u0440\u0432\u044B\u0439 \u0432\u0438\u0434\u0438\u043C\u044B\u0439 \u044D\u043B\u0435\u043C\u0435\u043D\u0442 \u043D\u0430 \u0441\u0442\u0440\u0430\u043D\u0438\u0446\u0435 (LCP)\r\n    lcpElements.forEach((element) => {\r\n        const rect = element.getBoundingClientRect();\r\n\r\n        // \u0423\u0447\u0438\u0442\u044B\u0432\u0430\u0435\u043C \u0442\u043E\u043B\u044C\u043A\u043E \u0442\u0435 \u044D\u043B\u0435\u043C\u0435\u043D\u0442\u044B, \u043A\u043E\u0442\u043E\u0440\u044B\u0435 \u0432\u0438\u0434\u043D\u044B \u0432 \u043E\u0431\u043B\u0430\u0441\u0442\u0438 \u044D\u043A\u0440\u0430\u043D\u0430\r\n        if (rect.top >= 0 && rect.top < window.innerHeight) {\r\n            // \u0414\u043B\u044F \u0438\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0439 \u0438 \u0432\u0438\u0434\u0435\u043E: \u043F\u0440\u043E\u0432\u0435\u0440\u044F\u0435\u043C \u043F\u043E \u0432\u044B\u0441\u043E\u0442\u0435\r\n            if (element instanceof HTMLImageElement || element instanceof HTMLVideoElement) {\r\n                if (!lcpElement || rect.height > lcpElement.clientHeight) {\r\n                    lcpElement = element;\r\n                }\r\n            }\r\n\r\n            // \u0414\u043B\u044F \u044D\u043B\u0435\u043C\u0435\u043D\u0442\u0430 <picture> \u043C\u044B \u0431\u0443\u0434\u0435\u043C \u0443\u0447\u0438\u0442\u044B\u0432\u0430\u0442\u044C \u0441\u0430\u043C\u044B\u0435 \u0431\u043E\u043B\u044C\u0448\u0438\u0435 \u0438\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u044F \u0432 \u0438\u0441\u0442\u043E\u0447\u043D\u0438\u043A\u0430\u0445\r\n            if (element instanceof HTMLPictureElement) {\r\n                const sources = element.querySelectorAll('source');\r\n                sources.forEach((source) => {\r\n                    const srcset = source instanceof HTMLSourceElement ? source.dataset.srcset || source.srcset : '';\r\n                    const type = source.type;\r\n\r\n                    if (srcset) {\r\n                        const image = new Image();\r\n                        image.srcset = srcset;\r\n                        image.onload = () => {\r\n                            const width = image.width;\r\n                            const height = image.height;\r\n                            if (!lcpElement || (height * width > lcpElement.clientWidth * lcpElement.clientHeight)) {\r\n                                lcpElement = element;\r\n                            }\r\n                        };\r\n\r\n                        // \u0415\u0441\u043B\u0438 \u044D\u0442\u043E webp, \u0434\u043E\u0431\u0430\u0432\u043B\u044F\u0435\u043C \u043F\u0440\u0435\u0434\u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0443 \u0441 \u0442\u0438\u043F\u043E\u043C image/webp\r\n                        if (type === 'image/webp') {\r\n                            const preloadLink = document.createElement('link');\r\n                            preloadLink.rel = 'preload';\r\n                            preloadLink.as = 'image';\r\n                            preloadLink.href = srcset;\r\n                            preloadLink.type = 'image/webp';\r\n                            document.head.appendChild(preloadLink);\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n\r\n            // \u0414\u043B\u044F \u0442\u0435\u043A\u0441\u0442\u043E\u0432\u044B\u0445 \u044D\u043B\u0435\u043C\u0435\u043D\u0442\u043E\u0432 (\u043D\u0430\u043F\u0440\u0438\u043C\u0435\u0440, \u0437\u0430\u0433\u043E\u043B\u043E\u0432\u043A\u043E\u0432 \u0438\u043B\u0438 \u0430\u0431\u0437\u0430\u0446\u0435\u0432) \u043C\u043E\u0436\u043D\u043E \u0440\u0430\u0441\u0441\u043C\u0430\u0442\u0440\u0438\u0432\u0430\u0442\u044C \u0438\u0445 \u0440\u0430\u0437\u043C\u0435\u0440\r\n            if (element.classList.contains('lcp-text')) {\r\n                const height = rect.height;\r\n                if (!lcpElement || height > lcpElement.clientHeight) {\r\n                    lcpElement = element;\r\n                }\r\n            }\r\n        }\r\n    });\r\n\r\n    // \u0415\u0441\u043B\u0438 LCP \u044D\u043B\u0435\u043C\u0435\u043D\u0442 \u043D\u0430\u0439\u0434\u0435\u043D, \u0434\u043E\u0431\u0430\u0432\u043B\u044F\u0435\u043C \u0435\u0433\u043E \u0432 \u043F\u0440\u0435\u0434\u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0443\r\n    if (lcpElement) {\r\n        let preloadLink: HTMLLinkElement | null = null;\r\n\r\n        // \u0414\u043B\u044F \u0438\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0439\r\n        if (lcpElement instanceof HTMLImageElement) {\r\n            preloadLink = document.createElement('link');\r\n            preloadLink.rel = 'preload';\r\n            preloadLink.as = 'image';\r\n            preloadLink.href = lcpElement.src;\r\n        } else if (lcpElement instanceof HTMLVideoElement) {\r\n            // \u0414\u043B\u044F \u0432\u0438\u0434\u0435\u043E, \u043F\u0440\u0435\u0434\u0437\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u043C \u0435\u0433\u043E \u0438\u0441\u0442\u043E\u0447\u043D\u0438\u043A\r\n            const videoSource = lcpElement.querySelector('source');\r\n            if (videoSource instanceof HTMLSourceElement) {\r\n                preloadLink = document.createElement('link');\r\n                preloadLink.rel = 'preload';\r\n                preloadLink.as = 'video';\r\n                preloadLink.href = videoSource.src;\r\n            }\r\n        } else if (lcpElement instanceof HTMLPictureElement) {\r\n            // \u0414\u043B\u044F picture, \u043F\u0440\u0435\u0434\u0437\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u043C \u0438\u0441\u0442\u043E\u0447\u043D\u0438\u043A\r\n            const pictureSource = lcpElement.querySelector('source');\r\n            if (pictureSource instanceof HTMLSourceElement) {\r\n                preloadLink = document.createElement('link');\r\n                preloadLink.rel = 'preload';\r\n                preloadLink.as = 'image';\r\n                preloadLink.href = pictureSource.srcset || pictureSource.dataset.srcset;\r\n\r\n                // \u0415\u0441\u043B\u0438 \u044D\u0442\u043E webp, \u0434\u043E\u0431\u0430\u0432\u043B\u044F\u0435\u043C \u0434\u043E\u043F\u043E\u043B\u043D\u0438\u0442\u0435\u043B\u044C\u043D\u0443\u044E \u043F\u0440\u0435\u0434\u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0443\r\n                if (pictureSource.type === 'image/webp') {\r\n                    preloadLink.type = 'image/webp';\r\n                }\r\n            }\r\n        } else if (lcpElement.classList.contains('lcp-text')) {\r\n            // \u0414\u043B\u044F \u0442\u0435\u043A\u0441\u0442\u043E\u0432\u044B\u0445 \u044D\u043B\u0435\u043C\u0435\u043D\u0442\u043E\u0432, \u0432\u043E\u0437\u043C\u043E\u0436\u043D\u043E, \u043D\u0435 \u043D\u0443\u0436\u043D\u043E \u0434\u043E\u0431\u0430\u0432\u043B\u044F\u0442\u044C \u0432 preload, \u043D\u043E \u043C\u043E\u0436\u043D\u043E \u043E\u0431\u0440\u0430\u0431\u043E\u0442\u0430\u0442\u044C \u043F\u043E-\u0441\u0432\u043E\u0435\u043C\u0443\r\n            console.log(\"LCP \u044D\u043B\u0435\u043C\u0435\u043D\u0442 - \u0442\u0435\u043A\u0441\u0442:\", lcpElement);\r\n        }\r\n\r\n        // \u0415\u0441\u043B\u0438 link \u0431\u044B\u043B \u0441\u043E\u0437\u0434\u0430\u043D, \u0434\u043E\u0431\u0430\u0432\u043B\u044F\u0435\u043C \u0435\u0433\u043E \u0432 head \u0434\u043B\u044F \u043F\u0440\u0435\u0434\u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0438\r\n        if (preloadLink) {\r\n            document.head.appendChild(preloadLink);\r\n        }\r\n    }\r\n}\r\n", "import { addPreloadToLCP } from './utils/LCPFile';\r\nwindow.addEventListener('load', () => {\r\n    addPreloadToLCP();\r\n});"],
  "mappings": "mBACO,SAASA,GAAwB,CACpC,IAAMC,EAA0F,CAC5F,GAAG,SAAS,iBAAiB,gCAAgC,CACjE,EAEIC,EAAiC,KAyDrC,GAtDAD,EAAY,QAASE,GAAY,CAC7B,IAAMC,EAAOD,EAAQ,sBAAsB,EAG3C,GAAIC,EAAK,KAAO,GAAKA,EAAK,IAAM,OAAO,eAE/BD,aAAmB,kBAAoBA,aAAmB,oBACtD,CAACD,GAAcE,EAAK,OAASF,EAAW,gBACxCA,EAAaC,GAKjBA,aAAmB,oBACHA,EAAQ,iBAAiB,QAAQ,EACzC,QAASE,GAAW,CACxB,IAAMC,EAASD,aAAkB,kBAAoBA,EAAO,QAAQ,QAAUA,EAAO,OAAS,GACxFE,EAAOF,EAAO,KAEpB,GAAIC,EAAQ,CACR,IAAME,EAAQ,IAAI,MAWlB,GAVAA,EAAM,OAASF,EACfE,EAAM,OAAS,IAAM,CACjB,IAAMC,EAAQD,EAAM,MACdE,EAASF,EAAM,QACjB,CAACN,GAAeQ,EAASD,EAAQP,EAAW,YAAcA,EAAW,gBACrEA,EAAaC,EAErB,EAGII,IAAS,aAAc,CACvB,IAAMI,EAAc,SAAS,cAAc,MAAM,EACjDA,EAAY,IAAM,UAClBA,EAAY,GAAK,QACjBA,EAAY,KAAOL,EACnBK,EAAY,KAAO,aACnB,SAAS,KAAK,YAAYA,CAAW,CACzC,CACJ,CACJ,CAAC,EAIDR,EAAQ,UAAU,SAAS,UAAU,GAAG,CACxC,IAAMO,EAASN,EAAK,QAChB,CAACF,GAAcQ,EAASR,EAAW,gBACnCA,EAAaC,EAErB,CAER,CAAC,EAGGD,EAAY,CACZ,IAAIS,EAAsC,KAG1C,GAAIT,aAAsB,iBACtBS,EAAc,SAAS,cAAc,MAAM,EAC3CA,EAAY,IAAM,UAClBA,EAAY,GAAK,QACjBA,EAAY,KAAOT,EAAW,YACvBA,aAAsB,iBAAkB,CAE/C,IAAMU,EAAcV,EAAW,cAAc,QAAQ,EACjDU,aAAuB,oBACvBD,EAAc,SAAS,cAAc,MAAM,EAC3CA,EAAY,IAAM,UAClBA,EAAY,GAAK,QACjBA,EAAY,KAAOC,EAAY,IAEvC,SAAWV,aAAsB,mBAAoB,CAEjD,IAAMW,EAAgBX,EAAW,cAAc,QAAQ,EACnDW,aAAyB,oBACzBF,EAAc,SAAS,cAAc,MAAM,EAC3CA,EAAY,IAAM,UAClBA,EAAY,GAAK,QACjBA,EAAY,KAAOE,EAAc,QAAUA,EAAc,QAAQ,OAG7DA,EAAc,OAAS,eACvBF,EAAY,KAAO,cAG/B,MAAWT,EAAW,UAAU,SAAS,UAAU,GAE/C,QAAQ,IAAI,mFAAwBA,CAAU,EAI9CS,GACA,SAAS,KAAK,YAAYA,CAAW,CAE7C,CACJ,CCxGA,OAAO,iBAAiB,OAAQ,IAAM,CAClCG,EAAgB,CACpB,CAAC",
  "names": ["addPreloadToLCP", "lcpElements", "lcpElement", "element", "rect", "source", "srcset", "type", "image", "width", "height", "preloadLink", "videoSource", "pictureSource", "addPreloadToLCP"]
}
